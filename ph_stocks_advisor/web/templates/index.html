{% extends "base.html" %}

{% block title %}PH Stocks Advisor â€” Analyse Philippine Stocks{% endblock %}

{% block content %}
<div class="hero">
  <h1>Philippine Stock Market<br><span class="accent-text">AI Advisor</span></h1>
  <p class="hero-sub">Enter a PSE stock symbol for an AI-powered <strong>BUY</strong> or <strong>NOT BUY</strong> analysis.</p>

  <form id="analyse-form" class="analyse-form" method="post" action="/analyse">
    <div class="input-group">
      <input
        type="text"
        id="symbol-input"
        name="symbol"
        placeholder="e.g. TEL, SM, BDO, ALI, JFC"
        autocomplete="off"
        required
      >
      <button type="submit" id="analyse-btn">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/></svg>
        Analyse
      </button>
    </div>
  </form>

  <!-- Task tracker: shows progress for each submitted stock -->
  <div id="tracker-panel" class="tracker-panel" style="display:none;">
    <h2 class="tracker-title">
      <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="1 4 1 10 7 10"/><path d="M3.51 15a9 9 0 1 0 2.13-9.36L1 10"/></svg>
      analysis queue <span id="tracker-count" class="tracker-count"></span>
    </h2>
    <table class="tracker-table">
      <thead>
        <tr>
          <th>Stock</th>
          <th>Status</th>
          <th>Time</th>
          <th></th>
        </tr>
      </thead>
      <tbody id="tracker-list"></tbody>
    </table>
    <p class="tracker-hint">You can keep adding more stocks while these run.</p>
  </div>

  <div id="error-area" class="error-area" style="display:none;">
    <p id="error-text"></p>
  </div>
</div>

<section class="recent-stocks" id="recent-stocks">
  <h2>
    <svg width="15" height="15" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>
    {% if current_user %}your analysed stocks{% else %}previously analysed stocks{% endif %}
  </h2>
  <div class="stock-chips-wrapper">
    <div class="stock-chips" id="stock-chips">
      {% for stock in recent_stocks %}
      <a href="/report/{{ stock.symbol }}" class="stock-chip" data-symbol="{{ stock.symbol }}">
        <span class="chip-symbol">{{ stock.symbol }}</span>
        <span class="chip-verdict badge-sm {{ 'buy' if stock.verdict == 'BUY' else 'not-buy' }}">{{ stock.verdict }}</span>
        <span class="chip-date">{{ stock.created_at.strftime('%b %d') }}</span>
      </a>
      {% endfor %}
    </div>
  </div>
</section>

<section class="features">
  <h2>
    <svg width="15" height="15" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><line x1="12" y1="16" x2="12" y2="12"/><line x1="12" y1="8" x2="12.01" y2="8"/></svg>
    how it works
  </h2>
  <div class="feature-grid">
    <div class="feature-card">
      <div class="feature-icon feature-icon-price">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#6c63ff" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><line x1="12" y1="1" x2="12" y2="23"/><path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"/></svg>
      </div>
      <h3>Price Analysis</h3>
      <p>Current price vs 52-week range, price catalysts detection.</p>
    </div>
    <div class="feature-card">
      <div class="feature-icon feature-icon-dividend">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#34d399" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><rect x="2" y="6" width="20" height="12" rx="2"/><circle cx="12" cy="12" r="2"/><path d="M6 12h.01M18 12h.01"/></svg>
      </div>
      <h3>Dividend Analysis</h3>
      <p>Yield, payout ratio, sustainability, REIT rules, income trends.</p>
    </div>
    <div class="feature-card">
      <div class="feature-icon feature-icon-movement">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#fbbf24" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><polyline points="22 7 13.5 15.5 8.5 10.5 2 17"/><polyline points="16 7 22 7 22 13"/></svg>
      </div>
      <h3>Movement Analysis</h3>
      <p>1-year trend, drawdown, candlestick patterns, multi-period performance.</p>
    </div>
    <div class="feature-card">
      <div class="feature-icon feature-icon-valuation">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#63b3ed" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M12 3v18"/><rect x="4" y="8" width="4" height="13" rx="1"/><rect x="10" y="5" width="4" height="16" rx="1"/><rect x="16" y="10" width="4" height="11" rx="1"/></svg>
      </div>
      <h3>Valuation</h3>
      <p>PE/PB/PEG ratios, Graham Number fair value estimate.</p>
    </div>
    <div class="feature-card">
      <div class="feature-icon feature-icon-risk">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#f87171" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"/><line x1="12" y1="9" x2="12" y2="13"/><line x1="12" y1="17" x2="12.01" y2="17"/></svg>
      </div>
      <h3>Controversy &amp; Risk</h3>
      <p>Price spike detection, risk factors, web news &amp; controversies.</p>
    </div>
    <div class="feature-card">
      <div class="feature-icon feature-icon-verdict">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#a78bfa" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><polyline points="14 2 14 8 20 8"/><line x1="16" y1="13" x2="8" y2="13"/><line x1="16" y1="17" x2="8" y2="17"/><polyline points="10 9 9 9 8 9"/></svg>
      </div>
      <h3>Final Verdict</h3>
      <p>AI consolidates all analyses into a BUY or NOT BUY recommendation.</p>
    </div>
  </div>
</section>
{% endblock %}

{% block scripts %}
<script src="{{ url_for('static', filename='app.js') }}"></script>
{% endblock %}
